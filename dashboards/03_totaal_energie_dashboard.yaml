# Totaal Energie Dashboard
# Compleet overzicht van elektriciteit, gas en kosten

views:
  - title: Energie Totaal
    path: energie-totaal
    icon: mdi:flash
    cards:
      # Header
      - type: custom:mushroom-title-card
        title: Energie Overzicht
        subtitle: Elektriciteit, Gas & Kosten
        
      # Quick stats
      - type: horizontal-stack
        cards:
          - type: tile
            entity: sensor.house_net_power
            name: Huidig Verbruik
            color: state
          - type: tile
            entity: sensor.grid_flow_direction
            name: Grid Status
            color: state
            
      # Dagverbruik
      - type: entities
        title: Verbruik Vandaag
        entities:
          - entity: sensor.electricity_consumption_daily
            name: Elektriciteit
            icon: mdi:flash
          - entity: sensor.gas_consumption_daily
            name: Gas
            icon: mdi:gas-burner
          - type: divider
          - entity: sensor.consumption_trend
            name: Trend vs Gisteren
            
      # Kosten overzicht
      - type: entities
        title: Kosten
        entities:
          - entity: sensor.electricity_cost_daily
            name: Elektriciteit Vandaag
          - entity: sensor.gas_cost_daily
            name: Gas Vandaag
          - entity: sensor.total_energy_cost_daily
            name: Totaal Vandaag
          - type: divider
          - entity: sensor.estimated_monthly_cost_total
            name: Geschatte Maandkosten
          - entity: sensor.cost_per_hour
            name: Kosten Per Uur
            
      # Tarieven
      - type: entities
        title: Actuele Tarieven
        entities:
          - entity: input_number.electricity_energy_price
            name: Elektriciteit Tarief
          - entity: sensor.gas_total_price
            name: Gas Totaalprijs
          - entity: input_number.capacity_tariff_price
            name: Capaciteitstarief
            
      # Apparaten overzicht
      - type: entities
        title: Apparaten
        entities:
          - entity: sensor.vaatwasser_status
            name: Vaatwasser
          - entity: sensor.washing_machine_status
            name: Wasmachine
          - entity: sensor.dryer_status
            name: Droogkast
          - type: divider
          - entity: sensor.total_appliances_power
            name: Totaal Apparaten
          - entity: binary_sensor.heavy_appliances_active
            name: Zware Apparaten Actief
            
      # Verbruiksgrafiek
      - type: custom:apexcharts-card
        header:
          show: true
          title: Verbruik Laatste 24u
        graph_span: 24h
        series:
          - entity: sensor.house_net_power
            name: Elektriciteit
            type: area
            color: blue
            group_by:
              func: avg
              duration: 15min
          - entity: sensor.gas_consumption_kwh
            name: Gas
            type: line
            color: orange
            y_axis_id: secondary
            group_by:
              func: last
              duration: 1h
        yaxis:
          - id: primary
            decimals: 0
            apex_config:
              title:
                text: Elektriciteit (W)
          - id: secondary
            opposite: true
            decimals: 1
            apex_config:
              title:
                text: Gas (kWh)
                
      # Daggemiddelde
      - type: custom:mushroom-template-card
        primary: Daggemiddelde
        secondary: >
          {{ states('sensor.daggemiddelde_verbruik') | round(1) }} kWh
          {% if states('sensor.consumption_trend') == 'Hoger dan gisteren' %}
            ðŸ“ˆ Hoger dan normaal
          {% elif states('sensor.consumption_trend') == 'Lager dan gisteren' %}
            ðŸ“‰ Lager dan normaal
          {% else %}
            âž¡ï¸ Normaal verbruik
          {% endif %}
        icon: mdi:chart-line
        icon_color: >
          {% if states('sensor.consumption_trend') == 'Hoger dan gisteren' %}
            orange
          {% elif states('sensor.consumption_trend') == 'Lager dan gisteren' %}
            green
          {% else %}
            blue
          {% endif %}
          
      # Contract info
      - type: entities
        title: Contract Informatie
        entities:
          - entity: input_text.fluvius_tarief_type
            name: Tarief Type
          - entity: sensor.fluvius_tariff_info
            name: Provider Info
          - type: custom:template-entity-row
            name: Contract Verloopt
            state: 2 november 2025
            icon: mdi:calendar-clock
            
      # Tips
      - type: markdown
        content: |
          ## ðŸ’¡ Energie Tips
          
          **Bespaar op je energierekening:**
          - ðŸŒ™ Gebruik zware apparaten 's nachts
          - ðŸ”Œ Vermijd gelijktijdig gebruik van apparaten
          - ðŸ“Š Blijf onder je capaciteitspiek
          - ðŸš— Laad je EV tijdens daluren
          
          **Huidige status:**
          - Capaciteitspiek: {{ (states('sensor.home_import_power_peak_31d') | float(0) / 1000) | round(2) }} kW
          - Beschikbaar: {{ states('sensor.available_capacity') }} W