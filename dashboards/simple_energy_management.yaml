# Simple Energy Dashboard - Works with standard Home Assistant
views:
  # ========================================
  # VIEW 1: OVERVIEW
  # ========================================
  - type: sections
    path: overview
    title: Energie Overzicht
    icon: mdi:home-lightning-bolt
    sections:
      # Status cards
      - type: grid
        cards:
          - type: tile
            entity: sensor.eth_dongle_pro_power_delivered
            name: Huidig Verbruik
            state_content:
              - state
            color: state
            
          - type: tile
            entity: sensor.beschikbaar_vermogen
            name: Beschikbaar
            state_content:
              - state
            color: state
            
          - type: tile
            entity: input_select.electricity_tariff_block
            name: Tarief
            state_content:
              - state
            color: state

      # Main gauge
      - type: grid
        cards:
          - type: gauge
            entity: sensor.eth_dongle_pro_power_delivered
            name: Totaal Verbruik
            min: 0
            max: 8000
            needle: true
            segments:
              - from: 0
                color: green
              - from: 4000
                color: yellow
              - from: 4200
                color: orange
              - from: 4400
                color: red

      # Appliance status
      - type: grid
        title: Apparaat Status
        cards:
          - type: entities
            title: Keuken Apparaten
            entities:
              - entity: switch.vaatwas
                name: Vaatwasser
                secondary_info: last-changed
              - entity: sensor.vaatwas_power
                name: Vaatwasser Verbruik
              - type: divider
              - entity: switch.koelkast_driepvries
                name: Koelkast
                secondary_info: last-changed
              - entity: sensor.koelkast_driepvries_power
                name: Koelkast Verbruik

          - type: entities
            title: Was Apparaten
            entities:
              - entity: switch.metered_wall_plug_switch
                name: Wasmachine
                secondary_info: last-changed
              - entity: sensor.metered_wall_plug_switch_power
                name: Wasmachine Verbruik
              - type: divider
              - entity: switch.droogkast
                name: Droogkast
                secondary_info: last-changed
              - entity: sensor.droogkast_power
                name: Droogkast Verbruik

          - type: entities
            title: Overige
            entities:
              - entity: switch.boiler
                name: Boiler
                secondary_info: last-changed
              - entity: sensor.boiler_power
                name: Boiler Verbruik
              - type: divider
              - entity: switch.waterker
                name: Waterkoker
                secondary_info: last-changed
              - entity: sensor.waterker_power
                name: Waterkoker Verbruik

      # Power distribution
      - type: grid
        cards:
          - type: history-graph
            title: Verbruik Historie (24u)
            entities:
              - entity: sensor.eth_dongle_pro_power_delivered
                name: Totaal
              - entity: sensor.vaatwas_power
                name: Vaatwasser
              - entity: sensor.metered_wall_plug_switch_power
                name: Wasmachine
              - entity: sensor.droogkast_power
                name: Droogkast
            hours_to_show: 24
            refresh_interval: 30
        
      # Lovelace Dashboard Card
# Voeg deze card toe aan je dashboard

type: vertical-stack
title: 🕐 Witgoed Tarief Control
cards:
  # Status Overview
  - type: horizontal-stack
    cards:
      - type: custom:button-card
        entity: sensor.tarief_status
        name: Huidig Tarief
        show_state: true
        size: 30%
        styles:
          card:
            - height: 80px
        state:
          - value: "Super-Dal"
            color: green
            icon: mdi:star-circle
          - value: "Dal"
            color: yellow
            icon: mdi:check-circle
          - value: "Piek"
            color: red
            icon: mdi:alert-circle
            
      - type: custom:button-card
        entity: sensor.volgende_tarief_wijziging
        name: Volgende
        show_state: true
        icon: mdi:clock-fast
        size: 30%
        styles:
          card:
            - height: 80px

  # Blokkering Control
  - type: entities
    show_header_toggle: true
    entities:
      - entity: input_boolean.witgoed_piek_blokkering_actief
        name: Automatische Piek Blokkering
        secondary_info: last-changed

  # Apparaten Status
  - type: entities
    title: Apparaten
    show_header_toggle: false
    entities:
      - entity: switch.wasmachine_met_blokkering
        name: Wasmachine
        secondary_info: >
          {% if states('input_boolean.wasmachine_blokkeer_piek') == 'on' %}
            Wacht op dal-tarief
          {% elif states('switch.wasmachine') == 'on' %}
            Actief
          {% else %}
            Uit
          {% endif %}
        
      - entity: switch.droogkast_met_blokkering
        name: Droogkast
        secondary_info: >
          {% if states('input_boolean.droogkast_blokkeer_piek') == 'on' %}
            Wacht op dal-tarief
          {% elif states('switch.droogkast') == 'on' %}
            Actief
          {% else %}
            Uit
          {% endif %}
        
      - entity: switch.vaatwasser_met_blokkering
        name: Vaatwasser
        secondary_info: >
          {% if states('input_boolean.vaatwasser_blokkeer_piek') == 'on' %}
            Wacht op dal-tarief
          {% elif states('switch.vaatwasser') == 'on' %}
            Actief
          {% else %}
            Uit
          {% endif %}

  # Schema Overview
  - type: markdown
    content: |
      ## ⏰ Tarief Schema
      
      🌙 **01:00 - 07:00** Super-Dal ✅
      ⚡ **07:00 - 11:00** PIEK ❌
      ☀️ **11:00 - 17:00** Dal ✅
      ⚡ **17:00 - 22:00** PIEK ❌
      🌃 **22:00 - 01:00** Dal ✅
      
      {% if states('binary_sensor.piek_tarief_actief') == 'on' %}
      ### ⚠️ PIEK ACTIEF
      **Apparaten geblokkeerd tot {{ state_attr('binary_sensor.piek_tarief_actief', 'einde_piek') }}**
      {% elif states('binary_sensor.super_dal_tarief_actief') == 'on' %}
      ### ✨ SUPER-DAL ACTIEF
      **Beste tijd voor witgoed!**
      {% else %}
      ### ✅ DAL ACTIEF
      **Goed moment voor witgoed**
      {% endif %}

  # Geblokkeerde Apparaten Indicator
  - type: conditional
    conditions:
      - entity: binary_sensor.piek_tarief_actief
        state: "on"
    card:
      type: custom:button-card
      name: >
        [[[
          let blocked = [];
          if (states['input_boolean.wasmachine_blokkeer_piek'].state == 'on') blocked.push('Wasmachine');
          if (states['input_boolean.droogkast_blokkeer_piek'].state == 'on') blocked.push('Droogkast');
          if (states['input_boolean.vaatwasser_blokkeer_piek'].state == 'on') blocked.push('Vaatwasser');
          if (blocked.length > 0) {
            return `Geblokkeerd: ${blocked.join(', ')}`;
          } else {
            return 'Geen apparaten geblokkeerd';
          }
        ]]]
      icon: mdi:timer-sand
      color: orange
      styles:
        card:
          - background-color: rgba(255, 152, 0, 0.1)
          - border: 1px solid orange

    # Alternatief: Compacte Mobile View
  - type: custom:mushroom-chips-card
    chips:
      - type: entity
        entity: sensor.tarief_status
        content_info: state
        icon_color: >
          {% if is_state('sensor.tarief_status', 'Piek') %}
            red
          {% elif is_state('sensor.tarief_status', 'Super-Dal') %}
            green
          {% else %}
            yellow
          {% endif %}
          
      - type: template
        content: >
          {% set count = 0 %}
          {% if states('input_boolean.wasmachine_blokkeer_piek') == 'on' %}
            {% set count = count + 1 %}
          {% endif %}
          {% if states('input_boolean.droogkast_blokkeer_piek') == 'on' %}
            {% set count = count + 1 %}
          {% endif %}
          {% if states('input_boolean.vaatwasser_blokkeer_piek') == 'on' %}
            {% set count = count + 1 %}
          {% endif %}
          {{ count }} wachtend
        icon: mdi:pause-circle
        icon_color: orange
        
      - type: entity
        entity: input_boolean.witgoed_piek_blokkering_actief
        content_info: none
        icon_color: >
          {% if is_state('input_boolean.witgoed_piek_blokkering_actief', 'on') %}
            green
          {% else %}
            grey
          {% endif %}

  # ========================================
  # VIEW 2: APPLIANCES
  # ========================================
  - type: sections
    path: appliances
    title: Apparaten Beheer
    icon: mdi:washing-machine
    sections:
      # Quick controls
      - type: grid
        cards:
          - type: entities
            title: Snelle Bediening
            entities:
              - entity: switch.vaatwas
                name: Vaatwasser
              - entity: switch.metered_wall_plug_switch
                name: Wasmachine
              - entity: switch.droogkast
                name: Droogkast
              - entity: switch.boiler
                name: Boiler
              - entity: switch.waterker
                name: Waterkoker
              - entity: switch.home_cinema
                name: Home Cinema
              - entity: switch.werkplaats
                name: Werkplaats

      # Capacity management
      - type: grid
        title: Capaciteit Beheer
        cards:
          - type: entities
            title: Automatisch Beheer
            entities:
              - entity: input_boolean.dishwasher_auto_mode
                name: Vaatwasser Auto
              - entity: input_boolean.washing_machine_auto_mode
                name: Wasmachine Auto
              - entity: input_boolean.dryer_auto_mode
                name: Droogkast Auto
              - entity: input_boolean.capacity_protection_active
                name: Capaciteitsbescherming

          - type: entities
            title: Cyclus Status
            entities:
              - entity: input_boolean.dishwasher_cycle_active
                name: Vaatwasser Cyclus
              - entity: input_boolean.washing_machine_cycle_active
                name: Wasmachine Cyclus
              - entity: input_boolean.dryer_cycle_active
                name: Droogkast Cyclus

      # Power usage
      - type: grid
        cards:
          - type: vertical-stack
            cards:
              - type: entities
                title: Verwacht Verbruik
                entities:
                  - entity: input_number.dishwasher_power_usage
                    name: Vaatwasser
                  - entity: input_number.washing_machine_power_usage
                    name: Wasmachine
                  - entity: input_number.dryer_power_usage
                    name: Droogkast

  # ========================================
  # VIEW 3: SETTINGS
  # ========================================
  - type: sections
    path: settings
    title: Instellingen
    icon: mdi:cog
    sections:
      # Capacity limits
      - type: grid
        cards:
          - type: entities
            title: Capaciteitslimieten
            entities:
              - entity: input_number.max_house_power
                name: Maximum verbruik
              - entity: input_number.capacity_warning_threshold
                name: Waarschuwing bij
              - entity: input_number.capacity_critical_threshold
                name: Kritiek bij
              - entity: input_number.appliance_standby_threshold
                name: Standby drempel

      # Statistics
      - type: grid
        cards:
          - type: statistics-graph
            title: Dagelijks Verbruik
            entities:
              - sensor.eth_dongle_pro_power_delivered
            stat_types:
              - mean
              - max
            period:
              days: 7

      # System info
      - type: grid
        cards:
          - type: entities
            title: Systeem Status
            entities:
              - entity: sensor.z_wave_usb_stick_status
                name: Z-Wave Status
              - entity: binary_sensor.fritz_box_7530_connection
                name: Internet Verbinding
              - entity: sensor.networkhdd2_cpu_gebruik_totaal
                name: NAS CPU Gebruik