# Missing Input Entities for Dashboards
# This file creates all missing input_numbers and input_booleans referenced in dashboards

input_number:
  # House power limits
  max_house_power:
    name: Maximum huis vermogen
    min: 1000
    max: 15000
    step: 100
    initial: 9200  # 40A @ 230V
    unit_of_measurement: W
    icon: mdi:home-lightning-bolt
    
  # Capacity thresholds
  capacity_warning_threshold:
    name: Capaciteit waarschuwing drempel
    min: 50
    max: 95
    step: 5
    initial: 80
    unit_of_measurement: "%"
    icon: mdi:alert
    
  capacity_critical_threshold:
    name: Capaciteit kritieke drempel
    min: 70
    max: 100
    step: 5
    initial: 95
    unit_of_measurement: "%"
    icon: mdi:alert-octagon
    
  # Appliance power usage settings
  dishwasher_power_usage:
    name: Vaatwasser vermogen
    min: 500
    max: 3000
    step: 100
    initial: 2200
    unit_of_measurement: W
    icon: mdi:dishwasher
    
  washing_machine_power_usage:
    name: Wasmachine vermogen
    min: 500
    max: 3000
    step: 100
    initial: 2400
    unit_of_measurement: W
    icon: mdi:washing-machine
    
  dryer_power_usage:
    name: Droogkast vermogen
    min: 500
    max: 3000
    step: 100
    initial: 2800
    unit_of_measurement: W
    icon: mdi:tumble-dryer
    
  appliance_standby_threshold:
    name: Apparaat standby drempel
    min: 1
    max: 20
    step: 1
    initial: 5
    unit_of_measurement: W
    icon: mdi:power-sleep

input_boolean:
  # Capacity protection
  capacity_protection_active:
    name: Capaciteit bescherming actief
    initial: true
    icon: mdi:shield-check
    
  # Peak blocking per appliance
  wasmachine_blokkeer_piek:
    name: Wasmachine blokkeer tijdens piek
    initial: true
    icon: mdi:clock-alert
    
  droogkast_blokkeer_piek:
    name: Droogkast blokkeer tijdens piek
    initial: true
    icon: mdi:clock-alert
    
  vaatwasser_blokkeer_piek:
    name: Vaatwasser blokkeer tijdens piek
    initial: true
    icon: mdi:clock-alert

# Template switches for blocking functionality
template:
  - switch:
      # Wallbox switch (alias for existing functionality)
      - name: "Wallbox laden"
        unique_id: wallbox_laden
        state: >
          {{ is_state('switch.wallbox_kristof_riebbels_pauzeren_hervatten', 'on') }}
        turn_on:
          service: switch.turn_on
          target:
            entity_id: switch.wallbox_kristof_riebbels_pauzeren_hervatten
        turn_off:
          service: switch.turn_off
          target:
            entity_id: switch.wallbox_kristof_riebbels_pauzeren_hervatten
        icon: mdi:ev-station
        
      # Appliance switches with blocking
      - name: "Wasmachine met blokkering"
        unique_id: wasmachine_met_blokkering
        state: >
          {{ is_state('switch.metered_wall_plug_switch', 'on') }}
        turn_on:
          - condition: or
            conditions:
              - condition: state
                entity_id: input_boolean.wasmachine_blokkeer_piek
                state: 'off'
              - condition: state
                entity_id: binary_sensor.piek_tarief_actief
                state: 'off'
          - service: switch.turn_on
            target:
              entity_id: switch.metered_wall_plug_switch
        turn_off:
          service: switch.turn_off
          target:
            entity_id: switch.metered_wall_plug_switch
        icon: mdi:washing-machine
        
      - name: "Droogkast met blokkering"
        unique_id: droogkast_met_blokkering
        state: >
          {{ is_state('switch.droogkast', 'on') }}
        turn_on:
          - condition: or
            conditions:
              - condition: state
                entity_id: input_boolean.droogkast_blokkeer_piek
                state: 'off'
              - condition: state
                entity_id: binary_sensor.piek_tarief_actief
                state: 'off'
          - service: switch.turn_on
            target:
              entity_id: switch.droogkast
        turn_off:
          service: switch.turn_off
          target:
            entity_id: switch.droogkast
        icon: mdi:tumble-dryer
        
      - name: "Vaatwasser met blokkering"
        unique_id: vaatwasser_met_blokkering
        state: >
          {{ is_state('switch.vaatwas', 'on') }}
        turn_on:
          - condition: or
            conditions:
              - condition: state
                entity_id: input_boolean.vaatwasser_blokkeer_piek
                state: 'off'
              - condition: state
                entity_id: binary_sensor.piek_tarief_actief
                state: 'off'
          - service: switch.turn_on
            target:
              entity_id: switch.vaatwas
        turn_off:
          service: switch.turn_off
          target:
            entity_id: switch.vaatwas
        icon: mdi:dishwasher

  - sensor:
      # Wallbox energy price (placeholder)
      - name: "Wallbox Kristof Riebbels energieprijs"
        unique_id: wallbox_kristof_riebbels_energieprijs
        state: "0.25"  # Default price €0.25/kWh
        unit_of_measurement: "€/kWh"
        device_class: monetary
        attributes:
          info: "Placeholder - configureer met werkelijke energieprijs"
          
      # Daily energy sensors (if not created by integration)
      - name: "Eth-Dongle-Pro Energy Delivered Daily"
        unique_id: eth_dongle_pro_energy_delivered_daily
        state: >
          {% set t1 = states('sensor.eth_dongle_pro_energy_delivered_t1_daily') | float(0) %}
          {% set t2 = states('sensor.eth_dongle_pro_energy_delivered_t2_daily') | float(0) %}
          {{ (t1 + t2) | round(3) }}
        unit_of_measurement: kWh
        device_class: energy
        state_class: total_increasing
        
      - name: "Eth-Dongle-Pro Energy Returned Daily"
        unique_id: eth_dongle_pro_energy_returned_daily
        state: >
          {% set t1 = states('sensor.eth_dongle_pro_energy_returned_t1_daily') | float(0) %}
          {% set t2 = states('sensor.eth_dongle_pro_energy_returned_t2_daily') | float(0) %}
          {{ (t1 + t2) | round(3) }}
        unit_of_measurement: kWh
        device_class: energy
        state_class: total_increasing

# Utility meters for daily tracking
utility_meter:
  eth_dongle_pro_energy_delivered_t1_daily:
    source: sensor.eth_dongle_pro_energy_delivered_t1
    cycle: daily
    
  eth_dongle_pro_energy_delivered_t2_daily:
    source: sensor.eth_dongle_pro_energy_delivered_t2
    cycle: daily
    
  eth_dongle_pro_energy_returned_t1_daily:
    source: sensor.eth_dongle_pro_energy_returned_t1
    cycle: daily
    
  eth_dongle_pro_energy_returned_t2_daily:
    source: sensor.eth_dongle_pro_energy_returned_t2
    cycle: daily
    
  eth_dongle_pro_gas_delivered_daily:
    source: sensor.eth_dongle_pro_gas_delivered
    cycle: daily